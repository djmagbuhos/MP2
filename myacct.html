<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      //-------------------------------
      ///ADDING ADDRESS
      async function putData(data, address) {
        let req = await fetch(data, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(address),
        });
        let res = await req.json();
        console.log(res);

        getData("http://localhost:3001/api/address");
      }

      async function getData(data) {
        let my_obj = await fetch(data);
        let my_text = await my_obj.text();
        let address = JSON.parse(my_text);

        $("#tbody_address").empty();

        for (let i = 0; i < address.length; i++) {
          let modalId = "edit_modal_" + i; // Unique modal ID
          let modalTarget = "#" + modalId; // Unique modal target

          let modal =
            '<div class="modal fade edit-modal" id="' +
            modalId +
            '" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="row text-center"><div class="col-lg-3"></div><div class="col-lg-6"><h1 class="display-5 my-3">Edit Address</h1><form id="edit_address_' +
            [i] +
            '"><label class="form-label" for="r_region">Region</label><select class="form-select form-control"><option selected>Metro Manila</option></select><label class="form-label" for="r_city">City</label><select class="form-select form-control" id="r_city"><option value="' +
            address[i].city +
            '" selected>' +
            address[i].city +
            '</option><option disabled>----------------</option><option value="Caloocan City">Caloocan</option><option value="Makati City">Makati</option><option value="Mandaluyong City">Mandaluyong</option><option value="Manila City">Manila</option><option value="Marikina City">Marikina</option><option value="Muntinlupa City">Muntinlupa</option><option value="Paranaque City">Paranaque</option><option value="Pasay City">Pasay</option><option value="Pasig City">Pasig</option><option value="Quezon City">Quezon City</option><option value="Taguig City">Taguig</option><option value="Valenzuela City">Valenzuela</option></select><label class="form-label" for="re_barangay">Barangay</label><input type="text" id="re_barangay" class="form-control" placeholder="' +
            address[i].barangay +
            '"/><label class="form-label" for="re_street">Street Name, Bldg/House No.</label><input type="text" id="re_street" class="form-control" placeholder="' +
            address[i].street +
            '"/><label class="form-label" for="re_name">Recipient Name</label><input type="text" id="re_name" class="form-control" placeholder="' +
            address[i].rec_name +
            '"/><label class="form-label" for="re_number">Mobile Number</label><div class="input-group mb-4"><span class="input-group-text">+63</span><input type="text" id="re_number" class="form-control" minlength="10" maxlength="10" placeholder="' +
            address[i].rec_mnumber +
            '"/></div><input type="submit" class="btn btn-success"/></form></div></div></div></div></div></div>';

          let add_address =
            "<tr><td>" +
            address[i].street +
            " " +
            address[i].barangay +
            " " +
            address[i].city +
            " Metro Manila</td><td>" +
            address[i].rec_name +
            "</td><td>+63" +
            address[i].rec_mnumber +
            "</td><td class='text-center'><button id='btedit' class='btn btn-warning py-1' data-bs-toggle='modal' data-bs-target='#edit_modal_" +
            i +
            "'>Edit</button> || <button id='btdel_address_" +
            address[i].address_id +
            "' class='btn btn-danger py-1'>Delete</button></td>";

          $("#tbody_address").append(add_address);
          $("body").append(modal);
        }
      }

      getData("http://localhost:3001/api/address");

      $(document).ready(function (x) {
        $("#add_address").submit(function (x) {
          let address_data = {
            city: $("#r_city").val(),
            barangay: $("#r_barangay").val(),
            street: $("#r_street").val(),
            rec_name: $("#r_name").val(),
            rec_mnumber: $("#r_number").val(),
          };
          x.preventDefault();

          putData("http://localhost:3001/api/address", address_data);
          getData("http://localhost:3001/api/address");
        });
      });
      ///END OF ADDING ADDRESS
      //-------------------------
    </script>
    <script>
      //----------------------------
      //DELETING ADDRESS
      $(document).ready(function () {
        $(document).on("click", "button.btn-danger", function () {
          let addressId = $(this).attr("id").split("_")[2];
          console.log("Deleting address with ID:", addressId);
          deleteAddress("http://localhost:3001/api/address/" + addressId);
        });
      });

      async function deleteAddress(data) {
        try {
          let req = await fetch(data, {
            method: "DELETE",
          });
          let res = await req.json();
          console.log("Delete response:", res);

          getData("http://localhost:3001/api/address");
        } catch (error) {
          console.error("Error deleting address:", error);
        }
      }
      // END OF DELETING ADDRESS
      //---------------------------
      //---------------------------
    </script>

    <script>
      $(document).ready(function () {
        $(document).on("submit", "form[id^='edit_address_']", function (event) {
          event.preventDefault();
          let formId = $(this).attr("id");
          let addressIndex = formId.split("_")[2];
          let editedAddress = {
            city: $("#r_city", this).val(),
            barangay: $("#re_barangay", this).val(),
            street: $("#re_street", this).val(),
            rec_name: $("#re_name", this).val(),
            rec_mnumber: $("#re_number", this).val(),
          };
          editAddress(
            "http://localhost:3001/api/address/" + addressIndex,
            editedAddress
          );
        });
      });

      async function editAddress(data, editedAddress) {
        try {
          let req = await fetch(data, {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(editedAddress),
          });
          let res = await req.json();
          console.log("Edit response:", res);
          getData("http://localhost:3001/api/address");
          $(`.edit-modal`).modal("hide");
        } catch (error) {
          console.error("Error editing address:", error);
        }
      }
    </script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <link rel="stylesheet" href="css/styles.css" />
    <title>Playstation World</title>
  </head>
  <body>
    <!-- TOP NAV -->

    <div class="container-fluid d-none d-sm-block" id="psw_topnav">
      <div class="container">
        <div class="row py-3" id="psw_topnav2">
          <div
            class="col-lg-4 d-flex justify-content-center align-items-center d-none d-sm-block"
          >
            <a href="#"
              ><img
                src="img/psw-logo.png"
                alt="weblogo"
                id="logo"
                width="300px"
            /></a>
          </div>

          <div class="col-lg-6">
            <form class="d-flex d-none d-sm-block">
              <div>
                <div class="input-group">
                  <input type="search" class="form-control" id="search-bar" />
                  <span class="input-group-text" id="search-bar-2"
                    ><a href="#" class="text-dark"
                      ><span class="material-symbols-outlined align-middle">
                        search
                      </span></a
                    ></span
                  >
                </div>
              </div>
            </form>
          </div>

          <div
            class="col-lg-2 d-flex justify-content-center align-items-center d-none d-sm-block text-center"
          >
            <a href="#" class="mx-2 nav_text">
              <span class="material-symbols-outlined mt-1 py-1">person</span>
            </a>
            <a href="cart-page.html" class="mx-2 nav_text">
              <span class="material-symbols-outlined mt-1 py-1"
                >shopping_cart</span
              >
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- NAVBAR -->

    <nav class="navbar navbar-expand-lg navbar-light" id="psw_navbar">
      <div class="container-fluid">
        <div class="container" id="nav_container">
          <button
            class="navbar-toggler text-white"
            data-bs-toggle="collapse"
            data-bs-target="#site-navbar"
          >
            <span class="navbar-toggler-icon"></span></button
          ><a href="#"
            ><img
              src="img/psw-logo-white.png"
              class="ms-4 d-sm-none"
              alt="weblogo"
              id="logo"
              width="200px"
          /></a>
          <div
            class="collapse navbar-collapse justify-content-center"
            id="site-navbar"
          >
            <ul class="navbar-nav w-100 nav-fill">
              <li class="nav-item">
                <a class="nav-link nav_link" href="index.html">
                  <strong>Home</strong></a
                >
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-link nav_link dropdown-toggle"
                  href="#"
                  data-bs-toggle="dropdown"
                  id="shop_now_dd"
                  ><strong>Shop Now</strong></a
                >
                <ul class="dropdown-menu w-100 dd_shopnow">
                  <li>
                    <a
                      class="li_dd dropdown-item text-center text-light"
                      href="shop_game.html"
                    >
                      GAMES</a
                    >
                  </li>
                  <li>
                    <a
                      class="li_dd dropdown-item text-center text-light"
                      href="shop_ca.html"
                    >
                      CONSOLE | ACCESSORIES</a
                    >
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a class="nav-link nav_link" href="#">
                  <strong>About Us </strong></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link nav_link" href="#">
                  <strong>Contact Us </strong></a
                >
              </li>
              <div class="d-sm-none">
                <li class="nav-item">
                  <a class="nav-link nav_link" href="#">
                    <strong>My Cart </strong></a
                  >
                </li>
                <li class="nav-item">
                  <a class="nav-link nav_link" href="#">
                    <strong>My Account </strong></a
                  >
                </li>
              </div>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- CONTENT -->
    <div class="container-fluid pb-4">
      <div class="container my-3">
        <div class="row">
          <div class="col-lg-4 my-4 text-center">
            <a href="#">
              <img
                src="img/my_acct/my_dp2.jpg"
                class="img-fluid"
                id="dp_myacct"
              />
            </a>
            <button class="btn btn-primary mt-3">Edit/Upload Picture</button>
          </div>
          <div class="col-lg-8 my-4">
            <div class="text-center">
              <h1 class="display-4 my-3">My Profile</h1>
            </div>
            <div>
              <p class="ms-5 fs-3 mt-4">
                <strong>Name:</strong> Juan Dela Cruz
              </p>
              <p class="ms-5 fs-3"><strong>Gender:</strong> Male</p>
              <p class="ms-5 fs-3">
                <strong>Mobile Number:</strong> +639123456789
              </p>
              <p class="ms-5 fs-3">
                <strong>Email Address:</strong> jdelacruz@gmail.com
              </p>
            </div>
          </div>
          <hr class="my-4 my-4" />
          <div class="text-center">
            <h1 class="display-4 my-3">My Address</h1>
          </div>
          <div>
            <table class="table">
              <tr>
                <th>Address</th>
                <th>Recipient</th>
                <th>Mobile Number</th>
                <th class="text-center">Action</th>
              </tr>
              <!-- <tr>
                <td>
                  123 Sawani Mari St. Maharlika Compound San Isidro Paranaque
                  City Metro Manila
                </td>
                <td>Juan Dela Cruz</td>
                <td>+639123456788</td>
                <td class="text-center">
                  <div>
                    <button
                      id="btedit"
                      class="btn btn-warning py-1"
                      data-bs-toggle="modal"
                      data-bs-target="#bt_edit_modal"
                    >
                      Edit
                    </button>

                    ||
                    <button id="btdel_address" class="btn btn-danger py-1">
                      Delete
                    </button>
                  </div>
                </td>
              </tr> -->
              <tbody id="tbody_address"></tbody>
              <!-- add address here -->
            </table>
          </div>
          <div class="row text-center">
            <div class="col-lg-3"></div>
            <div class="col-lg-6">
              <h1 class="display-5 my-3">Add Address</h1>
              <form id="add_address">
                <p class="text-danger" id="myacct_warning">
                  *Available in Metro Manila only, for outside Metro Manila
                  kindly visit us in our Shopee or Lazada page
                </p>
                <label class="form-label" for="r_region">Region</label>
                <select class="form-select form-control">
                  <option selected>Metro Manila</option>
                </select>

                <label class="form-label" for="r_city">City</label>
                <select class="form-select form-control" id="r_city">
                  <option value="Caloocan City">Caloocan</option>
                  <option value="Makati City">Makati</option>
                  <option value="Mandaluyong City">Mandaluyong</option>
                  <option value="Manila City">Manila</option>
                  <option value="Marikina City">Marikina</option>
                  <option value="Muntinlupa City">Muntinlupa</option>
                  <option value="Paranaque City">Paranaque</option>
                  <option value="Pasay City">Pasay</option>
                  <option value="Pasig City">Pasig</option>
                  <option value="Quezon City">Quezon City</option>
                  <option value="Taguig City">Taguig</option>
                  <option value="Valenzuela City">Valenzuela</option>
                </select>

                <label class="form-label" for="r_barangay">Barangay</label>
                <input type="text" id="r_barangay" class="form-control" />

                <label class="form-label" for="r_street"
                  >Street Name, Bldg/House No.</label
                >
                <input type="text" id="r_street" class="form-control" />

                <label class="form-label" for="r_name">Recipient's Name</label>
                <input type="text" id="r_name" class="form-control" />

                <label class="form-label" for="r_number">Mobile Number</label>
                <div class="input-group mb-4">
                  <span class="input-group-text">+63</span>
                  <input
                    type="text"
                    id="r_number"
                    class="form-control"
                    minlength="10"
                    maxlength="10"
                  />
                </div>
                <input type="submit" class="btn btn-success" />
              </form>
            </div>
            <div class="col-lg-3"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- EDIT BUTTON MODAL SAMPLE-->
    <div class="modal fade" id="bt_edit_modal" tabindex="-1">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="row text-center">
              <div class="col-lg-3"></div>
              <div class="col-lg-6">
                <h1 class="display-5 my-3">Edit Address</h1>
                <form id="edit_address">
                  <label class="form-label" for="r_region">Region</label>
                  <select class="form-select form-control">
                    <option selected>Metro Manila</option>
                  </select>

                  <label class="form-label" for="r_city">City</label>
                  <select class="form-select form-control" id="r_city">
                    <option value="'' + address[i].city + '" selected>
                      ' + address[i].city + '
                    </option>
                    <option disabled>----------------</option>
                    <option value="Caloocan City">Caloocan</option>
                    <option value="Makati City">Makati</option>
                    <option value="Mandaluyong City">Mandaluyong</option>
                    <option value="Manila City">Manila</option>
                    <option value="Marikina City">Marikina</option>
                    <option value="Muntinlupa City">Muntinlupa</option>
                    <option value="Paranaque City">Paranaque</option>
                    <option value="Pasay City">Pasay</option>
                    <option value="Pasig City">Pasig</option>
                    <option value="Quezon City">Quezon City</option>
                    <option value="Taguig City">Taguig</option>
                    <option value="Valenzuela City">Valenzuela</option>
                  </select>

                  <label class="form-label" for="re_barangay">Barangay</label>
                  <input
                    type="text"
                    id="re_barangay"
                    class="form-control"
                    placeholder="' + address[i].barangay + '"
                  />

                  <label class="form-label" for="re_street"
                    >Street Name, Bldg/House No.</label
                  >
                  <input
                    type="text"
                    id="re_street"
                    class="form-control"
                    placeholder="' + address[i].street + '"
                  />

                  <label class="form-label" for="re_name"
                    >Recipient's Name</label
                  >
                  <input
                    type="text"
                    id="re_name"
                    class="form-control"
                    placeholder="' + address[i].rec_name + '"
                  />

                  <label class="form-label" for="re_number"
                    >Mobile Number</label
                  >
                  <div class="input-group mb-4">
                    <span class="input-group-text">+63</span>
                    <input
                      type="text"
                      id="re_number"
                      class="form-control"
                      minlength="10"
                      maxlength="10"
                      placeholder="' + address[i].rec_mnumber + '"
                    />
                  </div>
                  <input type="submit" class="btn btn-success" />
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="container-fluid text-center" id="footer_newsletter">
      <div class="container pt-4">
        <div class="row">
          <div class="col-lg-6">
            <p class="text-light">
              <strong>Sign Up to Newsletter: </strong>Be the first to learn
              about promotions, special events, new arrivals and more!
            </p>
          </div>
          <div class="col-lg-6">
            <form
              class="d-flex align-items-center justify-content-center d-none d-sm-block"
            >
              <div>
                <div class="input-group">
                  <input
                    type="search"
                    class="form-control"
                    id="subscribe-bar"
                  />
                  <span class="input-group-text" id="subscribe-bar-2">
                    <a href="#" class="text-dark">
                      <span class="align-middle text-light">Subscribe </span>
                    </a>
                  </span>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid pb-5" id="footer-container">
      <br />
      <br />
      <div class="container" id="footer-container2">
        <div class="row">
          <div class="col-lg-3">
            <p class="fs-5"><strong>Contact Us</strong></p>
            <p class="fs-6 footer_link2">support@playstationworld.ph</p>
            <p class="fs-6 footer_link2">+63922 895 0320</p>
            <p class="fs-6 footer_link2">+63922 895 0323</p>
            <p class="fs-6 footer_link2">+639123456789</p>
          </div>
          <div class="col-lg-3">
            <p class="fs-5"><strong>COMPANY</strong></p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none">About Us</a>
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none"
                >Terms of Use</a
              >
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none">FAQs</a>
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none"
                >Privacy and Policy</a
              >
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none"
                >Store Locations</a
              >
            </p>
          </div>
          <div class="col-lg-3">
            <p class="fs-5"><strong>Customer Care</strong></p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none"
                >My Account</a
              >
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none"
                >Shopping Cart</a
              >
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none">Warranty</a>
            </p>
            <p class="fs-6">
              <a href="#" class="footer_link text-decoration-none">Feedback</a>
            </p>
          </div>
          <div class="col-lg-3">
            <p class="fs-5"><strong>Follow Us</strong></p>
            <a href="#"
              ><img
                src="img/footer-logo/facebook-logo.png"
                class="me-1 img-fluid footer_sm_logo"
            /></a>
            <a href="#"
              ><img
                src="img/footer-logo/instagram-logo.png"
                class="me-1 img-fluid footer_sm_logo"
            /></a>
            <a href="#"
              ><img
                src="img/footer-logo/tiktok-logo.png"
                class="me-1 img-fluid footer_sm_logo"
            /></a>
            <a href="#"
              ><img
                src="img/footer-logo/twitter-logo2.png"
                class="me-1 img-fluid footer_sm_logo"
            /></a>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid py-3" id="footer_bottom">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 mt-2">
            <p id="fbot_text">
              © 2024 Dante Magbuhos Jr | dj.magbuhos@gmail.com & Keith Aquino |
              keithaquino@gmail.com
            </p>
          </div>
          <div class="col-lg-6" style="text-align: right">
            <img
              src="img/footer-logo/pay_logo_botfooter.png"
              alt="payment logos"
              width="280px"
            />
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
